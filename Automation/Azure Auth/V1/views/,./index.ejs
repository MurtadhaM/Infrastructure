<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Demo</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src='main.js'></script>
</head>
<body>
    
    <h1>Graph API Demo</h1>
    <p>Click the button below to see your profile information:</p>

    
    <form id="listEmails" action="/listEmails" method="get">
        <input type="submit" value="List Emails">
    </form>
   
    <form id="listUsers" action="/listUsers" method="get">
        <input type="submit" value="List Users">
    </form>


    <form action="/sendEmail" method="post">
        <input type="text" name="to" placeholder="To">
        <input type="text" name="subject" placeholder="Subject">
        <input type="text" name="body" placeholder="Body">
        <input type="submit" value="Send Email">
    </form>

    <div id="Users">
        <h2>Users</h2>
        <ul id="usersList">

            <% if (!users) { %>
                <% users.forEach(function(user) { %>

                    <li><span>Email: </span><%= user.userPrincipalName %></li>
                    <li><span>Name: </span><%= user.displayName %></li>
                <% }); %>
            <% } %>  

            <% if (error) { %>
                <li><span>Error: </span><%= error %></li>
            <% } %>

        </ul>
        

        <h2>Emails</h2>
        <ul id="emailsList">

            <% if (!emails) { %>
                <% emails.forEach(function(email) { %>

                    <li><span>From: </span><%= email.from.emailAddress.address %></li>
                    <li><span>Subject: </span><%= email.subject %></li>
                    <li><span>Body: </span><%= email.bodyPreview %></li>
                <% }); %>
            <% } %>  

            <% if (error) { %>
                <li><span>Error: </span><%= error %></li>
            <% } %>

        </ul>

        </div>
    </div>

</body>
</html>